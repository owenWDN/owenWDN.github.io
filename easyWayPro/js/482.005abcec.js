"use strict";(self["webpackChunkoneselfeasyway"]=self["webpackChunkoneselfeasyway"]||[]).push([[482],{1234:function(e,t,s){s.d(t,{Z:function(){return ie}});var o=s(3396),i=s(7156),l=s.p+"img/choose.5a633d5e.png";const a={class:"box"},n={class:"box_bore"},d=(0,o._)("div",{class:"psd_title"},"乘客信息/Traveler",-1),r={key:0,class:"psd_cont"},p=(0,o._)("div",null,[(0,o._)("span",null,"请至少添加一名乘客"),(0,o._)("span",null,"Please add at least one passenger")],-1),c=[p],_={class:"user_info"},m={class:"contact"},h={class:"phone"},u=(0,o._)("span",null,"手机号/Mobile:",-1),g={class:"id_no"},f=(0,o._)("span",null,"证件号/ID No:",-1),y={class:"delet"},N={key:1,style:{"font-size":"10px",color:"#ff4141","text-align":"left","padding-bottom":"12px","font-weight":"600"}},x=(0,o._)("span",null,"非中国大陆始发行程，请联系您的旅行顾问咨询优惠报价。 For origins outside mainland China, please contact our TC to get favorable fare",-1),v=[x],I={class:"psd_"},w={class:"head_title"},k={class:"add_traveler"},b={class:"van-flex"},C=(0,o._)("i",{class:"van-colx"},[(0,o._)("span",null,"手机号/Mobile No"),(0,o._)("span",null,"证件号/ID No")],-1),P={class:"van-colx"},$={key:0},S={key:1},O=["onClick"],V=(0,o._)("img",{src:l,alt:""},null,-1),D=[V],M={class:"lfp2_btn"},U=(0,o._)("span",null,[(0,o.Uk)("新增乘机人"),(0,o._)("br"),(0,o.Uk)("New Traveler")],-1),Z=[U],z=(0,o._)("br",null,null,-1),F={class:"edit"},B={class:"head_title"},W={class:"from"},T={class:"from_box"},A={class:"from_item"},E={class:"from_item"},J={class:"from_box"},q={class:"from_item"},H={class:"from_item"},R={class:"from_box"},j={class:"from_item"},K={class:"from_item"},X={style:{margin:"16px"}},G=(0,o._)("br",null,null,-1);function Y(e,t,s,l,p,x){const V=(0,o.up)("van-checkbox"),U=(0,o.up)("van-icon"),Y=(0,o.up)("van-search"),L=(0,o.up)("van-checkbox-group"),Q=(0,o.up)("van-popup"),ee=(0,o.up)("van-field"),te=(0,o.up)("van-button"),se=(0,o.up)("van-form"),oe=(0,o.up)("van-picker");return(0,o.wg)(),(0,o.iD)("div",a,[(0,o._)("div",n,[d,0==e.$store.state.choose_psg.length&&0==p.list.length?((0,o.wg)(),(0,o.iD)("div",r,c)):(0,o.kq)("",!0),((0,o.wg)(!0),(0,o.iD)(o.HY,null,(0,o.Ko)(e.$store.state.choose_psg,((e,s)=>((0,o.wg)(),(0,o.iD)("div",{class:"psd_cont",key:s},[(0,o._)("div",null,[(0,o._)("div",_,[(0,o.Wm)(V,{ref_for:!0,ref:"Checkbox",modelValue:p.checked,"onUpdate:modelValue":t[0]||(t[0]=e=>p.checked=e),shape:"square"},{default:(0,o.w5)((()=>[(0,o.Uk)((0,i.zw)(e.FltPaxnameDom),1)])),_:2},1032,["modelValue"]),(0,o._)("span",m,[(0,o._)("div",h,[u,(0,o._)("span",null,(0,i.zw)(x.Xplus(e.MobileNo1,3,4)),1)]),(0,o._)("div",g,[f,(0,o._)("span",null,(0,i.zw)(x.Xplus(p.cryptox.decrypt(e.IdNo),4,4)),1)])]),(0,o._)("span",y,[(0,o.Wm)(U,{name:"delete-o",size:"18",onClick:e=>x.deletep(s)},null,8,["onClick"])])])])])))),128)),(0,o._)("div",{class:"add",onClick:t[1]||(t[1]=e=>p.showPicker4=!0)},[(0,o._)("div",null,[(0,o.Wm)(U,{name:"plus",size:"25"})])]),"/internationalflight"==e.$route.path?((0,o.wg)(),(0,o.iD)("div",N,v)):(0,o.kq)("",!0)]),(0,o.Wm)(Q,{class:"select_popup",show:p.showPicker4,"onUpdate:show":t[7]||(t[7]=e=>p.showPicker4=e),round:"",position:"bottom",style:{height:"55%"}},{default:(0,o.w5)((()=>[(0,o._)("div",I,[(0,o._)("div",w,[(0,o.Uk)(" 添加乘机人/Add Traveler "),(0,o._)("span",null,[(0,o.Wm)(U,{name:"close",size:"23",onClick:t[2]||(t[2]=e=>p.showPicker4=!1)})])]),p.searchpsg_more?(0,o.kq)("",!0):((0,o.wg)(),(0,o.j4)(Y,{key:0,modelValue:e.$store.state.searchpsg,"onUpdate:modelValue":t[3]||(t[3]=t=>e.$store.state.searchpsg=t),placeholder:"查询乘机人/Searache Traveler"},null,8,["modelValue"])),p.searchpsg_more?(0,o.kq)("",!0):((0,o.wg)(),(0,o.j4)(L,{key:1,class:"select_popup_psg",modelValue:e.$store.state.choose_psg_p,"onUpdate:modelValue":t[4]||(t[4]=t=>e.$store.state.choose_psg_p=t),ref:"checkboxGroup"},{default:(0,o.w5)((()=>[((0,o.wg)(!0),(0,o.iD)(o.HY,null,(0,o.Ko)(x.psg_search,((e,t)=>((0,o.wg)(),(0,o.j4)(V,{key:t,name:e,shape:"square"},{default:(0,o.w5)((()=>[(0,o._)("div",k,[(0,o._)("i",null,[(0,o._)("span",null,(0,i.zw)(e.FltPaxnameDom)+" -- "+(0,i.zw)(e.FltPaxnameInt),1)]),(0,o._)("div",b,[C,(0,o._)("i",P,[(0,o._)("span",null,(0,i.zw)(x.Xplus(e.MobileNo1,3,4)),1),null!=e.IdNo?((0,o.wg)(),(0,o.iD)("span",$,(0,i.zw)(x.Xplus(p.cryptox.decrypt(e.IdNo),4,4)),1)):((0,o.wg)(),(0,o.iD)("span",S,"not data"))]),(0,o._)("i",{class:"",onClick:e=>x.edit(t)},D,8,O)])])])),_:2},1032,["name"])))),128))])),_:1},8,["modelValue"])),(0,o._)("div",M,[(0,o._)("div",{class:"lfp2_btn_y",onClick:t[5]||(t[5]=e=>x.edit())},Z),(0,o._)("div",{class:"lfp2_btn_n",onClick:t[6]||(t[6]=(...e)=>x.add_psg&&x.add_psg(...e))},[(0,o.Uk)("确认"),z,(0,o.Uk)("Confirm")])])])])),_:1},8,["show"]),(0,o.Wm)(Q,{class:"select_popup",show:p.showPicker5,"onUpdate:show":t[17]||(t[17]=e=>p.showPicker5=e),round:"",position:"bottom",style:{height:"45%"}},{default:(0,o.w5)((()=>[(0,o._)("div",F,[(0,o._)("div",B,[(0,o.Uk)((0,i.zw)(e.title)+" ",1),(0,o._)("span",null,[(0,o.Wm)(U,{name:"close",size:"23",onClick:t[8]||(t[8]=e=>{p.showPicker5=!1,p.showPicker4=!0})})])]),(0,o._)("div",W,[(0,o.Wm)(se,{onSubmit:x.on_save_psg},{default:(0,o.w5)((()=>[(0,o._)("div",T,[(0,o._)("div",A,[(0,o.Wm)(ee,{class:"from_i_field",modelValue:p.eidt_p.FltPaxnameDom,"onUpdate:modelValue":t[9]||(t[9]=e=>p.eidt_p.FltPaxnameDom=e),name:"姓名",label:"姓名/Name",placeholder:"姓名/Name",rules:[{required:!0,message:"请填写姓名"}]},null,8,["modelValue"])]),(0,o._)("div",E,[(0,o.Wm)(ee,{class:"from_i_field",modelValue:p.eidt_p.idtype,"onUpdate:modelValue":t[10]||(t[10]=e=>p.eidt_p.idtype=e),name:"证件类型",label:"证件类型/ID Type",readonly:"",placeholder:"证件类型",onClick:t[11]||(t[11]=e=>p.idtype_s=!0),rules:[{required:!0,message:"请选择证件类型"}]},null,8,["modelValue"])])]),(0,o._)("div",J,[(0,o._)("div",q,[(0,o.Wm)(ee,{class:"from_i_field",modelValue:p.eidt_p.IdNo,"onUpdate:modelValue":t[12]||(t[12]=e=>p.eidt_p.IdNo=e),name:"证件号",label:"证件号/ID No",placeholder:"证件号",rules:[{required:!0,message:"请填写证件号"}]},null,8,["modelValue"])]),(0,o._)("div",H,[(0,o.Wm)(ee,{class:"from_i_field",modelValue:p.eidt_p.MobileNo1,"onUpdate:modelValue":t[13]||(t[13]=e=>p.eidt_p.MobileNo1=e),name:"手机号",label:"手机号/Mobile",placeholder:"手机号",rules:[{required:!0,message:"请填写手机号"}]},null,8,["modelValue"])])]),(0,o._)("div",R,[(0,o._)("div",j,[(0,o.Wm)(ee,{class:"from_i_field",modelValue:x.getSex,"onUpdate:modelValue":t[14]||(t[14]=e=>x.getSex=e),name:"性别",label:"性别/Gender",readonly:"",placeholder:"性别",onClick:t[15]||(t[15]=e=>p.idtype_sex=!0),rules:[{required:!0,message:"请选择证件性别"}]},null,8,["modelValue"])]),(0,o._)("div",K,[(0,o.Wm)(ee,{class:"from_i_field",modelValue:p.eidt_p.EmailCompany,"onUpdate:modelValue":t[16]||(t[16]=e=>p.eidt_p.EmailCompany=e),name:"邮箱",label:"邮箱/Email",placeholder:"邮箱"},null,8,["modelValue"])])]),(0,o._)("div",X,[(0,o.Wm)(te,{round:"",block:"",type:"info","native-type":"submit",color:"linear-gradient(180deg, #0792DF 0%, #035ABB 99%, #0359BB 100%)"},{default:(0,o.w5)((()=>[(0,o.Uk)("保存"),G,(0,o.Uk)("Save")])),_:1})])])),_:1},8,["onSubmit"])])])])),_:1},8,["show"]),(0,o.Wm)(Q,{class:"select_popup",show:p.idtype_s,"onUpdate:show":t[19]||(t[19]=e=>p.idtype_s=e),round:"",position:"bottom"},{default:(0,o.w5)((()=>[(0,o.Wm)(oe,{"show-toolbar":"","allow-html":"","confirm-button-text":"确认/confirm","cancel-button-text":"取消/cancel",columns:x.get_this_list(p.indexidtypes,p.idtype_se),onConfirm:x.choose_idt,onCancel:t[18]||(t[18]=e=>p.idtype_s=!1),onChange:x.change_idt},null,8,["columns","onConfirm","onChange"])])),_:1},8,["show"]),(0,o.Wm)(Q,{class:"select_popup",show:p.idtype_sex,"onUpdate:show":t[21]||(t[21]=e=>p.idtype_sex=e),round:"",position:"bottom"},{default:(0,o.w5)((()=>[(0,o.Wm)(oe,{"show-toolbar":"","allow-html":"","confirm-button-text":"确认/confirm","cancel-button-text":"取消/cancel",columns:p.sex_list,onConfirm:x.choose_sex,onCancel:t[20]||(t[20]=e=>p.idtype_sex=!1)},null,8,["columns","onConfirm"])])),_:1},8,["show"])])}s(560);var L=s(1469),Q=s(9650),ee=s(9374),te={name:"psgcont",data(){return{showPicker4:!1,showPicker5:!1,idtype_s:!1,idtype_sex:!1,searchpsg_more:!1,checked:!0,eidt_p:[],list:[],cryptox:L.Z,idtype_se:"",indexidtypes:[{value:"身份证",text:"身份证/Mainland Chinese ID Card"},{value:"护照",text:"护照/PASSPORT"},{value:"大陆居民往来港澳通行证",text:"大陆居民往来港澳通行证/Entry-Exit Permit for HK/Macau"},{value:"港澳居民来往内地通行证",text:"港澳居民来往内地通行证/Mainland Travel Permit for HK/Macau Residents"},{value:"台湾居民往来大陆通行证",text:"台湾居民往来大陆通行证/Mainland Travel Permit for Taiwan Residents"},{value:"港澳台居民居住证",text:"港澳台居民居住证/Residence Permit for Hong Kong, Macau, and Taiwan Residents"},{value:"其他证件类型",text:"其他证件类型/Other types of documents"}],sex_list:[{text:"男",value:"M"},{text:"女",value:"F"}]}},computed:{psg_search(){let e=this.$store.state.searchpsg;if(!e)return this.$store.state.psglist;let t=this.$store.state.psglist.filter((t=>-1!=t.FltPaxnameDom.indexOf(e)||-1!=t.FltPaxnameInt.indexOf(e)||-1!=t.MobileNo1.indexOf(e)));return t},getSex:{get(){return this.sexx(this.eidt_p.Sex)},set(e){console.log(e),this.eidt_p.Sex=e}}},created(){this.dataCollationPassenger()},methods:{Xplus(e="",t,s){if(!e)return"";var o=e.length-t-s,i="";return 0!=o.length&&(i="****"),e.substring(0,t)+i+e.substring(e.length-s)},dataCollationPassenger(){let e={};if(sessionStorage.getItem("psglist_json")&&(e=JSON.parse(sessionStorage.getItem("psglist_json")),e.psglist.filter((e=>(e.idtype="身份证",e.IdCardNo="",e.IdNo?e.IdNo==e.PassportNo?e.idtype="护照":e.IdNo==e.HkmcEepNo?e.idtype="大陆居民往来港澳通行证":e.IdNo==e.ReentryPermitNo?e.idtype="港澳居民来往内地通行证":e.IdNo==e.MtpNo?e.idtype="台湾居民往来大陆通行证":e.IdNo==e.gatIdNo?e.idtype="港澳台居民居住证":e.IdCardNo=e.IdNo:e.PassportNo?(e.idtype="护照",e.IdNo=e.PassportNo):e.HkmcEepNo?(e.idtype="港澳通行证",e.IdNo=e.HkmcEepNo):e.ReentryPermitNo?(e.idtype="港澳居民来往内地通行证",e.IdNo=e.ReentryPermitNo):e.MtpNo?(e.idtype="台湾居民往来大陆通行证",e.IdNo=e.MtpNo):e.gatIdNo&&(e.idtype="港澳台居民居住证",e.IdNo=e.gatIdNo),e.Identification,e.idtype)))),0==this.$store.state.psglist.length&&e.psglist&&e.psglist.length>0&&this.$store.commit("setpsglist",e.psglist),sessionStorage.getItem("choose_psg")){let e=JSON.parse(sessionStorage.getItem("choose_psg"));this.$store.commit("choose_psg_m",e)}if(sessionStorage.getItem("choose_psg_more")){let e=JSON.parse(sessionStorage.getItem("choose_psg_more"));this.$store.commit("choose_psg_more_m",e)}if(0==this.$store.state.choose_psg.length&&e.psglist&&e.psglist.length>0){let t=JSON.parse(JSON.stringify([e.psglist[0]]));this.$store.commit("choose_psg_m",t)}},deletep(e){(0,Q.vC)({message:"确定删除吗/Are you sure to delete?",theme:"round-button",confirmButtonText:"确定/Confirm",confirmButtonColor:"linear-gradient(160deg, #0274c9 0%, #044db5 100%)",showCancelButton:!0,cancelButtonText:"取消/Cancel",cancelButtonColor:"linear-gradient(160deg, rgb(199 199 199) 0%, rgb(173 173 173) 100%)"}).then((()=>{this.$store.state.choose_psg.splice(e,1),this.$store.commit("delete_psg_more",e),sessionStorage.setItem("choose_psg",JSON.stringify(this.$store.state.choose_psg))})).catch((()=>{}))},edit(e){this.showPicker4=!1;let t=null;e||0==e?(t=JSON.parse(JSON.stringify(this.$store.state.psglist[e])),this.title="修改乘机人/Updated Profile"):(t={ID:null,FltPaxnameDom:"",IdNo:"",DeptName:"无",Sex:"",FltPaxnameInt:"",MobileNo1:"",Birthday:"",CltId:null,idtype:"",Authid:null,PreferOther:"",EmailCompany:""},this.title="新增乘机人/increase Profile"),console.log(t),t.IdNo=L.Z.decrypt(t.IdNo),this.eidt_p=t,this.showPicker5=!0},sexx(e){return"M"==e?"男":"F"==e?"女":void 0},on_save_psg(e){let t=JSON.parse(JSON.stringify(this.eidt_p));console.log(t);let s={"男":"M","女":"F",M:"M",F:"F"},o=/^1\d{10}$/,i=/^[0-9A-Za-z]{15,18}$/;o.test(t.MobileNo1)?"身份证"==t.idtype&&(i=/^[0-9A-Za-z]{15,18}$/,!i.test(t.IdNo)||t.IdNo.indexOf("*")>0||15!=t.IdNo.length&&18!=t.IdNo.length)?this.messConfirm_ui("请完整输入正确的身份证号"):"护照"==t.idtype&&(i=/^[0-9A-Za-z]{5,18}$/,console.log(1),!i.test(t.IdNo)||t.IdNo.indexOf("*")>0)?this.messConfirm_ui("请完整输入正确的护照号"):"大陆居民往来港澳通行证"==t.idtype&&(i=/^[0-9A-Za-z]{5,18}$/,!i.test(t.IdNo)||t.IdNo.indexOf("*")>0)?this.messConfirm_ui("请完整输入正确的大陆居民往来港澳通行证"):"港澳居民来往内地通行证"==t.idtype&&(i=/^[0-9A-Za-z]{5,18}$/,!i.test(t.IdNo)||t.IdNo.indexOf("*")>0)?this.messConfirm_ui("请完整输入正确的港澳居民来往内地通行证"):"台湾居民往来大陆通行证"==t.idtype&&(i=/^[0-9A-Za-z]{5,18}$/,!i.test(t.IdNo)||t.IdNo.indexOf("*")>0)||"港澳台居民居住证"==t.idtype&&(i=/^[0-9A-Za-z]{5,18}$/,!i.test(t.IdNo)||t.IdNo.indexOf("*")>0)?this.messConfirm_ui("请完整输入正确的台湾居民往来大陆通行证"):"其他证件类型"==t.idtype&&(i=/^[0-9A-Za-z]{5,18}$/,!i.test(t.IdNo)||t.IdNo.indexOf("*")>0)?this.messConfirm_ui("请完整输入正确的其他证件类型"):(this.eidt_p.Identification||(t.ID=this.$store.state.psglist.length+1,t.FltPaxnameDom=t.FltPaxnameDom,t.IdNo=t.IdNo,t.DeptName="无",t.Sex=s[t.Sex],t.FltPaxnameInt=t.FltPaxnameInt,t.MobileNo1=t.MobileNo1,t.Birthday=t.Birthday?t.Birthday:"1970-01-01",t.CltId=this.$store.state.psglist[0].CltId,t.idtype=t.idtype,t.Authid=this.$store.state.psglist[0].Identification,t.PreferOther=t.PreferOther?t.PreferOther:""),console.log("newpsg",t),t.IdNo=L.Z.encrypt_up(t.IdNo),this.save_p(t).then((e=>{let t=e.data;if(console.log("result",t),t.indexOf("success")>=0){this.eidt_p.Identification=t.split("#")[1],console.log(this.eidt_p),this.$store.commit("update_psg",this.eidt_p);let e="",s="";(0,ee.Z)({type:"GET",url:"https://timas.efasco.com/ErpService.asmx/GetPassengerBystaffnoAES?staff_no="+sessionStorage.getItem("StaffNo")+"&paxname="+e+"&companyjde="+s,cache:"false",dataType:"json"}).then((e=>{console.log("vv",e),this.$store.commit("setpsglist",e.data.psglist),this.messConfirm_ui("新增成功/New succeed.")}));this.showPicker5=!1}else t.indexOf("diffname")>=0?this.messConfirm_ui("由于您的个人信息与机票预定平台信息验证不一致,清联系TravelDesk确认您的个人信息"):this.messConfirm_ui("保存失败")}))):this.messConfirm_ui("请输入正确的手机号码")},async save_p(e){return console.log(e),ee.Z.post("https://timas.efasco.com/ErpService.asmx/SavePassengerBystaffnoByAES",JSON.stringify(e).replace(/\+/g,"%2B").replace(/\&/g,"%26"))},add_psg(){console.log("add",this.$store.state.choose_psg_p);for(var e=[],t=0;t<this.$store.state.choose_psg_p.length;t++)e[this.$store.state.choose_psg_p[t].$id]=this.$store.state.choose_psg_p[t];for(var s in console.log(e),this.$store.state.choose_psg_p=[],e)s==e[s].$id&&this.$store.state.choose_psg_p.push(e[s]);console.log(this.$store.state.choose_psg_p);let o=JSON.parse(JSON.stringify(this.$store.state.choose_psg_p));this.$store.commit("choose_psg_m",o),sessionStorage.setItem("choose_psg",JSON.stringify(this.$store.state.choose_psg)),this.showPicker4=!1},get_this_list(e,t){let s=e||[];if(!t)return s},choose_idt(e){this.eidt_p.idtype=e.selectedOptions[0].value,this.idtype_s=!1},change_idt(e){const t=e.selectedValues[0];"护照"==t?(this.eidt_p.IdNo=L.Z.decrypt(this.eidt_p.PassportNo),console.log("护照"),console.log(this.eidt_p)):"大陆居民往来港澳通行证"==t?(console.log("大陆居民往来港澳通行证"),this.eidt_p.IdNo=L.Z.decrypt(this.eidt_p.HkmcEepNo),console.log(this.eidt_p)):"港澳居民来往内地通行证"==t?(console.log("港澳居民来往内地通行证"),this.eidt_p.IdNo=L.Z.decrypt(this.eidt_p.ReentryPermitNo),console.log(this.eidt_p)):"台湾居民往来大陆通行证"==t?(console.log("台湾居民往来大陆通行证"),this.eidt_p.IdNo=L.Z.decrypt(this.eidt_p.MtpNo),console.log(this.eidt_p)):"港澳台居民居住证"==t?(console.log("港澳台居民居住证"),this.eidt_p.IdNo=L.Z.decrypt(this.eidt_p.gatIdNo),console.log(this.eidt_p)):"其他证件类型"==t?(console.log("其他证件类型"),this.eidt_p.IdNo=L.Z.decrypt(this.eidt_p.OtherIdNo),console.log(this.eidt_p)):(this.eidt_p.IdNo=L.Z.decrypt(this.eidt_p.IdCardNo),console.log("身份证"),console.log(this.eidt_p))},messConfirm_ui(e){(0,Q.vC)({message:e,theme:"round-button",confirmButtonText:"确定/Confirm",confirmButtonColor:"linear-gradient(160deg, #0274c9 0%, #044db5 100%)"})},choose_sex(e){this.eidt_p.Sex=e.selectedOptions[0].value,this.idtype_sex=!1,console.log(this.eidt_p)}}},se=s(89);const oe=(0,se.Z)(te,[["render",Y]]);var ie=oe}}]);
//# sourceMappingURL=482.005abcec.js.map